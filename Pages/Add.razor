@page "/add"
@inject DataService DataService
@using DialogueDeGestion.Models
@inject IJSRuntime JS
@using DialogueDeGestion.Shared
@inject NavigationManager NavigationManager

<PageTitle>Ajout Dialogue</PageTitle>

<h1>Add New Dialogue</h1>

<form>
    <div>
        <label>Code :</label>
        <input @bind="newDialogue.DCODE" class="form-control" />
    </div>
    <div>
        <label>Macro Designation :</label>
        <input @bind="newDialogue.DGMACRODESIGNATION" class="form-control" />
    </div>
    <div>
        <label>Nature du Besoin :</label>
        <input @bind="newDialogue.DGNATUREDUBESOIN" class="form-control" />
    </div>
    <div>
        <label>Cadre d'achat :</label>
        <input @bind="newDialogue.DGCADREDACHAT" class="form-control" />
    </div>
    <div>
        <label>Fournisseur :</label>
        <input @bind="newDialogue.DGFOURNISSEUR" class="form-control" />
    </div>
    <div>
        <label>N° tiers :</label>
        <input @bind="newDialogue.DGNTIERS" class="form-control" />
    </div>
    <div>
        <label>Libellé du marché :</label>
        <input @bind="newDialogue.DGLIBELLEDUMARCHE" class="form-control" />
    </div>
    <div>
        <label>Masse budgétaire :</label>
        <input @bind="newDialogue.DGMASSEBUDGETAIRE" class="form-control" />
    </div>
    <div>
        <label>Demande d'achat :</label>
        <input @bind="newDialogue.DGDA" class="form-control" />
    </div>
    <div>
        <label>Axe national 1 :</label>
        <input @bind="newDialogue.DGAXENATIONAL1" class="form-control" />
    </div>
    <div>
        <label>Grand projet :</label>
        <input @bind="newDialogue.DGGRANDPROJET" class="form-control" />
    </div>
    <div>
        <label>Nom projet :</label>
        <input @bind="newDialogue.DGNOMPROJET" class="form-control" />
    </div>
    <div>
        <label>Statut projet G2PI :</label>
        <input @bind="newDialogue.DGSTATUTPROJETG2PI" class="form-control" />
    </div>
    <div>
        <label>Code initiative SDSI :</label>
        <input @bind="newDialogue.DGCODEINITIATIVESDSI" class="form-control" />
    </div>
    <div>
        <label>Objet initiative :</label>
        <input @bind="newDialogue.DGOBJECTINITIATIVE" class="form-control" />
    </div>
    <div>
        <label>Compte budgétaire :</label>
        <input @bind="newDialogue.DGCOMPTESBUDGETAIRES" class="form-control" />
    </div>
    <div>
        <label>Compte comptable :</label>
        <input @bind="newDialogue.DGCOMPTESCOMPTABLES" class="form-control" />
    </div>
    <div>
        <label>Portefeuille :</label>
        <input @bind="newDialogue.DGPORTEFEUILLE" class="form-control" />
    </div>
    <div>
        <label>Sous portefeuille :</label>
        <input @bind="newDialogue.DGSOUSPORTEFEUILLE" class="form-control" />
    </div>
    <div>
        <label>Caractéristique du besoin :</label>
        <input @bind="newDialogue.DGCARACTERISTIQUEDUBESOIN" class="form-control" />
    </div>
    <div>
        <label>Criticité :</label>
        <input @bind="newDialogue.DGCRITICITE" class="form-control" />
    </div>
    <div>
        <label>Budget initial demandé :</label>
        <input @bind="newDialogue.DGBUDGETINITIALDEMANDE" class="form-control" />
    </div>
    <div>
        <label>Budget DG1 demandé :</label>
        <input @bind="newDialogue.DGBUDGETDG1DEMANDE" class="form-control" />
    </div>
    <div>
        <label>Budget DG2 demandé :</label>
        <input @bind="newDialogue.DGBUDGETDG2DEMANDE" class="form-control" />
    </div>
    <div>
        <label>Budget DG3 demandé :</label>
        <input @bind="newDialogue.DGBUDGETDG3DEMANDE" class="form-control" />
    </div>
    <div>
        <label>Budget DG4 demandé :</label>
        <input @bind="newDialogue.DGBUDGETDG4DEMANDE" class="form-control" />
    </div>
    <div>
        <label>Demande report identifié :</label>
        <input @bind="newDialogue.DGDEMANDEDEREPORTIDENTIFIE" class="form-control" />
    </div>
    <div>
        <label>Plan budg BI janvier :</label>
        <input @bind="newDialogue.DGPLANBUDGBIJANVIER" class="form-control" />
    </div>
    <div>
        <label>Plan budg BR1 juillet :</label>
        <input @bind="newDialogue.DGPLANBUDGBR1JUILLET" class="form-control" />
    </div>
    <div>
        <label>Plan budg BR2 novembre :</label>
        <input @bind="newDialogue.DGPLANBUDGBR2NOVEMBRE" class="form-control" />
    </div>
    <div>
        <label>Numéro AB :</label>
        <input @bind="newDialogue.DGNUMEROAB" class="form-control" />
    </div>
    <div>
        <label>Numéro DB :</label>
        <input @bind="newDialogue.DGNUMERODB" class="form-control" />
    </div>
    <div>
        <label>BI autorisé :</label>
        <input @bind="newDialogue.DGBIAUTORISE" class="form-control" />
    </div>
    <div>
        <label>BR1 autorisé :</label>
        <input @bind="newDialogue.DGBR1AUTORISE" class="form-control" />
    </div>
    <div>
        <label>BR2 autorisé :</label>
        <input @bind="newDialogue.DGBR2AUTORISE" class="form-control" />
    </div>
    <div>
        <label>N° commande :</label>
        <input @bind="newDialogue.DGNCOMMANDE" class="form-control" />
    </div>
    <div>
        <label>Date de Début :</label>
        <input @bind="newDialogue.DGDATEDEDEBUT" type="date" class="form-control" />
    </div>
    <div>
        <label>Date de Fin :</label>
        <input @bind="newDialogue.DGDATEDEFIN" type="date" class="form-control" />
    </div>
    <div>
        <label>Montant Commandé :</label>
        <input @bind="newDialogue.DGMONTANTCOMMANDE" class="form-control" />
    </div>
    <div>
        <label>N° engagement :</label>
        <input @bind="newDialogue.DGNENGAGEMENT" class="form-control" />
    </div>
    <div>
        <label>Montant engagé :</label>
        <input @bind="newDialogue.DGMONTANTENGAGE" class="form-control" />
    </div>
    <div>
        <label>Réalisé :</label>
        <input @bind="newDialogue.DGREALISE" class="form-control" />
    </div>
    <div>
        <label>GA486 année N+1 :</label>
        <input @bind="newDialogue.DGGA486ANNEEN1" class="form-control" />
    </div>
    <div>
        <label>GA486 année N+2 :</label>
        <input @bind="newDialogue.DGGA486ANNEEN2" class="form-control" />
    </div>
    <div>
        <label>GA486 année N+3 :</label>
        <input @bind="newDialogue.DGGA486ANNEEN3" class="form-control" />
    </div>
    <div>
        <label>GA486 année N+4 :</label>
        <input @bind="newDialogue.DGGA486ANNEEN4" class="form-control" />
    </div>
    <div>
        <label>Budg prev N+1 :</label>
        <input @bind="newDialogue.DGBUDGPREVN1" class="form-control" />
    </div>
    <div>
        <label>Budg prev N+2 :</label>
        <input @bind="newDialogue.DGBUDGPREVN2" class="form-control" />
    </div>
    <div>
        <label>Budg prev N+3 :</label>
        <input @bind="newDialogue.DGBUDGPREVN3" class="form-control" />
    </div>
    <div>
        <label>Budg prev N+4 :</label>
        <input @bind="newDialogue.DGBUDGPREVN4" class="form-control" />
    </div>
    <div>
        <label>Commentaires :</label>
        <input @bind="newDialogue.DGCOMMENTAIRES" class="form-control" />
    </div>
    <div>
        <label>Année :</label>
        <input @bind="newDialogue.DGANNEE" class="form-control" />
    </div>
    <div>
        <label>Série de données :</label>
        <input @bind="newDialogue.DGSERIEDEDONNEES" class="form-control" />
    </div>
    <!-- Add more fields as per the table structure -->

    <button type="button" class="btn btn-success" @onclick="ConfirmAdd">Ajouter</button>
    <button type="button" class="btn btn-danger" @onclick="CancelAdd">Annuler</button>
</form>

@code {
    private Dialogue newDialogue = new Dialogue();

    private async Task ConfirmAdd()
    {
        var confirmed = await JS.InvokeAsync<bool>("confirm", "Are you sure you want to add this dialogue?");
        if (confirmed)
        {
            await AddDialogue();
        }
    }

    private async Task AddDialogue()
    {
        await DataService.AddDialogueAsync(newDialogue);
        NavigationManager.NavigateTo("/select"); // Adjust the path as needed
    }

    private void CancelAdd()
    {
        newDialogue = new Dialogue(); // Reset form
        NavigationManager.NavigateTo("/select"); // Adjust the path as needed
    }
}